<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
  <title>
   FEMTUS ソフトウェア開発ドキュメント
  </title>
  <meta content="width=device-width" name="viewport"/>
  <meta content="FEMTUS ソフトウェア開発ドキュメント " name="title"/>
  <link href="favicon.ico" rel="shortcut icon"/>
  <link href="styles/docfx.vendor.min.css" rel="stylesheet"/>
  <link href="styles/docfx.css" rel="stylesheet"/>
  <link href="styles/main.css" rel="stylesheet"/>
  <meta content="toc.json" property="docfx:navrel"/>
  <meta content="toc.json" property="docfx:tocrel"/>
 </head>
 <body data-offset="120" data-spy="scroll" data-target="#affix">
  <div id="wrapper">
   <header>
    <nav class="navbar navbar-inverse ng-scope" id="autocollapse" role="navigation">
     <div class="container">
      <div class="navbar-header">
       <button class="navbar-toggle" data-target="#navbar" data-toggle="collapse" type="button">
        <span class="sr-only">
         Toggle navigation
        </span>
        <span class="icon-bar">
        </span>
        <span class="icon-bar">
        </span>
        <span class="icon-bar">
        </span>
       </button>
       <a class="navbar-brand" href="index.html">
        <img alt="" class="svg" id="logo" src="logo.svg"/>
       </a>
      </div>
      <div class="collapse navbar-collapse" id="navbar">
       <form class="navbar-form navbar-right" id="search" role="search">
        <div class="form-group">
         <input autocomplete="off" class="form-control" id="search-query" placeholder="Search" type="text"/>
        </div>
       </form>
       <ul class="nav level1 navbar-nav">
        <li>
         <a href="articles/articles/intro.html" title="Articles">
          Articles
         </a>
        </li>
        <li>
         <a href="api/api/index.html" title="Api Documentation">
          Api Documentation
         </a>
        </li>
       </ul>
      </div>
     </div>
    </nav>
    <div class="subnav navbar navbar-default">
     <div class="container hide-when-search" id="breadcrumb">
      <ul class="breadcrumb">
       <li>
       </li>
      </ul>
     </div>
    </div>
   </header>
   <div class="container body-content hide-when-search" role="main">
    <div class="article row grid">
     <div class="col-md-10">
      <article class="content wrap" data-uid="" id="_content">
       <h1 id="femtus-ソフトウェア開発ドキュメント">
        FEMTUS Software Development Document
       </h1>
       <h2 id="contents">
        Contents
       </h2>
       <ul>
        <li>
         Quick Start
         <ul>
          <li>
           <a href="#loading-modules">
            Loading Modules
           </a>
          </li>
          <li>
           <a href="#hello-world">
            Hello World
           </a>
          </li>
          <li>
           <a href="#creating-gui">
            Creating GUI
           </a>
          </li>
         </ul>
        </li>
        <li>
         Quick Reference
         <ul>
          <li>
           Base
           <ul>
            <li>
             <a class="xref" href="api/api/JEOL.FEMTUS.Base.ContainerContract.IContainerProvider.html">
              IContainerProvider
             </a>
            </li>
            <li>
             <a class="xref" href="api/api/JEOL.FEMTUS.Base.ContainerContract.IContainerRegistry.html">
              IContainerRegistry
             </a>
            </li>
            <li>
             <a href="xref:JEOL.FEMTUS.Base.ModuleContract.IModule">
              IModule
             </a>
            </li>
           </ul>
          </li>
          <li>
           Framework
           <ul>
            <li>
             <a class="xref" href="api/api/JEOL.FEMTUS.Framework.LogContract.ILogService.html">
              Log
             </a>
            </li>
            <li>
             <a class="xref" href="api/api/JEOL.FEMTUS.Framework.OutputContract.IOutputService.html">
              Output
             </a>
            </li>
            <li>
             <a class="xref" href="api/api/JEOL.FEMTUS.Framework.RibbonMenuContract.IRibbonMenuService.html">
              RibbonMenu
             </a>
            </li>
           </ul>
          </li>
          <li>
           Feature
           <ul>
            <li>
             <a class="xref" href="api/api/JEOL.FEMTUS.Features.MicroscopeContract.IMicroscopeService.html">
              Microscope
             </a>
            </li>
            <li>
             <a class="xref" href="api/api/JEOL.FEMTUS.Features.CameraContract.ICamera.html">
              Camera
             </a>
            </li>
           </ul>
          </li>
         </ul>
        </li>
        <li>
         Api reference
         <ul>
          <li>
           <a class="xref" href="api/api/JEOL.FEMTUS.html">
            Top page
           </a>
          </li>
         </ul>
        </li>
       </ul>
       <h2 id="quick-start">
        Quick Start
       </h2>
       <h3 id="loading-modules">
        Loading Modules
       </h3>
       <p>
        The FEMTUS base module has a module loading function, which loads all the assemblies in the "C:\ProgramData\JEOL\FEMTUS\Plugins" folder.Find the class that implements the IModule interface from the loaded assembly, create an instance, and call the method.The main methods that the class that inherited the IModule implements are as follows.
       </p>
       <ol>
        <li>
         Initialize()
        </li>
        <li>
         Begin()
        </li>
        <li>
         Terminate()
        </li>
       </ol>
       <p>
        FEMTUS calls Initialize() for all IModule implementation classes, and then Begin() for all classes.Terminate() for all classes is called at the end of the application.The Initialize() method initializes the internal module and registers the interface.Begin() performs the initialization process that requires the call of other modules.Terminate() performs the termination process of the module.Be careful not to cause memory or resource leakage.
       </p>
       <h3 id="hello-world">
        Hello World
       </h3>
       <p>
        This explains how to create a plugin that displays "Hello, World" on the output screen.
       </p>
       <p>
        The diagram below shows the class diagram.
       </p>
       <p>
        <img alt="" src="docs/images/DiagramOfHelloWorld.jpg"/>
       </p>
       <p>
        The HelloWorldPlugin class is recognized as a plug-in from FEMTUS by implementing the IModule interface.
       </p>
       <p>
        The HelloWorldPlugin class calls ILogService, the interface of the LogService module, to output strings to the output screen.
       </p>
       <p>
        The interfaces for other modules are obtained from IcontainerProvier.
       </p>
       <p>
        If you want to publish the interface of the plug-in you created, use IcontainerRegister.
       </p>
       <p>
        Shows how to create a plug-in.
       </p>
       <ol>
        <li>
         Create a new project to generate a C#class library using Visual Studio 2022 with the name HelloWorldPlugin.By default, the assembly name is HelloWorldPlugin.dll.
        </li>
        <li>
         The framework to use is ".NET6".
        </li>
        <li>
         Add the assemblies that are distributed as the required FEMTUS plug-in SDK in the Add Reference menu in the HelloWorldPlugin project you created.In this case, add ModuleContract.dll, ContainerContract.dll, and OutputContract.dll.
        </li>
        <li>
         Create a HelloWorld.cs file for the created project.
         <img alt="" src="docs/images/VisualStudioProject.jpg"/>
        </li>
        <li>
         Add an implementation to the HelloWorld.cs file.
        </li>
        <li>
         three points.
        </li>
       </ol>
       <ul>
        <li>
         Inherit and implement the IModule. (IModuleInfo and ILicenseInfo should be implemented freely.)
        </li>
        <li>
         Gets the IOutputService interface from the IcontainerProvider passed by the Begin() method.
        </li>
        <li>
         Output strings using the WriteLine() method in the IOutputService interface.
        </li>
       </ul>
       <pre><code class="lang-cs">	public class HelloWorld : ModuleBase
	{
		public override IModuleInfo ModuleInfo { get; } = new ModuleInfo() { Name = "HelloWorld", Version = "1.0.0", Author = "JEOL.Ltd" };

		public override ILicenseInfo LicenseInfo { get; } = new LicenseInfo { HasLicense = true };

		public override void Begin(IContainerProvider containerProvider)
		{
			//take an interface from container.
			var output = containerProvider.Resolve&lt;IOutputService&gt;();
			output.WriteLine("Hello, World.");
		}

		public override void Initialize(IContainerRegistry containerRegistry)
		{
			//TODO: register interfaces.
		}

		public override void Terminate()
		{
		}
	}

</code></pre>
       <ol start="7">
        <li>
         <p>
          Build the HelloWorldPlugin project.
         </p>
        </li>
        <li>
         <p>
          "HelloWorldPlugin" generated
          <strong>
           .dll
          </strong>
          "Hello WorldPlugin".
          <strong>
           .deps.json
          </strong>
          plug-in folder (
          <a href="#module-loading">
           See Module Loading
          </a>
          Copy it to your computer.
          <strong>
           Do not copy the assemblies of the distributed FEMTUS plug-in SDK.
          </strong>
          <img alt="" src="docs/images/PutPlugin.jpg"/>
         </p>
        </li>
        <li>
         <p>
          Start FEMTUS and check that "Hello, World" is displayed on the output screen.
         </p>
        </li>
       </ol>
       <p>
        <img alt="" src="docs/images/ExecutionOfHelloWorld.jpg"/>
       </p>
       <h3 id="creating-gui">
        Creating GUI
       </h3>
       <p>
        Here's how to add a new menu and button to the ribbon menu and create a plug-in that displays the screen from the button.
        <img alt="" src="docs/images/DiagramOfSampleGUI.jpg"/>
        Use IRibbonMenuService to add buttons to the ribbon menu; use IDialogBoxService to display the screen.
       </p>
       <ol>
        <li>
         Create a new project that generates a WPF class library using Visual Studio 2022, named SampleGUIPlugin. By default, the assembly name is SampleGUIPlugin.dll.
        </li>
        <li>
         The framework to use is ".NET6".
        </li>
        <li>
         Copy the Contracts folder in the distributed SDK to the folder where you have created the SampleGUIPlugin project file (.csproj).
        </li>
        <li>
         Right-click on the SampleGUIPlugin project in Visual Studio's Solution Explorer and add the necessary assemblers from the Add References menu from the folder copied in Step 3.In this case, add ModuleContract.dll, ContainerContract.dll, DisplayContract.dll, RibbonMenuContract.dll, and BaseLibrary.dll.
        </li>
        <li>
         Create a SampleGUIPluginModule.cs file for the created project.
        </li>
        <li>
         Add the implementation to the SampleGUIPluginModule.cs file.
         <ol>
          <li>
           Inherit ModuleBase Class
          </li>
          <li>
           Get the IRibbonMenuService interface
          </li>
          <li>
           Get IDialogBoxService interface
          </li>
         </ol>
        </li>
       </ol>
       <pre><code class="lang-cs">	public class SampleGUIPluginModule: ModuleBase
	{
		public override IModuleInfo ModuleInfo { get; } = new ModuleInfo { Name = "SampleGUIPluginModule", Version = "1.0.0", Author = "JEOL.Ltd" };

		public override ILicenseInfo LicenseInfo { get; } = new LicenseInfo { HasLicense = true };

		IContainerProvider m_ContainerProvider;
		IRibbonMenuService m_RibbonMenuService;
		IDialogBoxService m_DialogBoxService;

		public override void Begin(IContainerProvider containerProvider)
		{
			m_ContainerProvider = containerProvider;
			m_RibbonMenuService = containerProvider.Resolve&lt;IRibbonMenuService&gt;();
			m_DialogBoxService = containerProvider.Resolve&lt;IDialogBoxService&gt;();
		}

		public override void Initialize(IContainerRegistry containerRegistry)
		{
		}

		public override void Terminate()
		{
		}
	}

</code></pre>
       <ol start="6">
        <li>
         <p>
          Adds a new WPF user control to the SampleGUIPlugin project in Visual Studio's Solution Explorer, named SampleGUI, and implements TextBlock as shown in the diagram.
          <img alt="" src="docs/images/SampleGUI.jpg"/>
         </p>
        </li>
        <li>
         <p>
          Add to SampleGUIPluginModule.cs file.
         </p>
         <ol>
          <li>
           Add tabs and buttons to the ribbon menu
          </li>
          <li>
           Display the Sample GUI screen from the ribbon menu button
          </li>
         </ol>
        </li>
       </ol>
       <pre><code class="lang-cs">	public class SampleGUIPluginModule: ModuleBase
	{
		public override IModuleInfo ModuleInfo { get; } = new ModuleInfo { Name = "SampleGUIPluginModule", Version = "1.0.0", Author = "JEOL.Ltd" };

		public override ILicenseInfo LicenseInfo { get; } = new LicenseInfo { HasLicense = true };

		IContainerProvider m_ContainerProvider;
		IRibbonMenuService m_RibbonMenuService;
		IDialogBoxService m_DialogBoxService;

		public override void Begin(IContainerProvider containerProvider)
		{
			m_ContainerProvider = containerProvider;
			m_RibbonMenuService = containerProvider.Resolve&lt;IRibbonMenuService&gt;();
			m_DialogBoxService = containerProvider.Resolve&lt;IDialogBoxService&gt;();

			CreateRibbonMenu();
		}

		public override void Initialize(IContainerRegistry containerRegistry)
		{
		}

		public override void Terminate()
		{
		}

		void CreateRibbonMenu()
		{
			var button = m_RibbonMenuService.GenerateButtonRibbonMenu(Guid.NewGuid(), "Sample Button", ShowSampleGUI);
			var groupId = Guid.NewGuid();
			var group = m_RibbonMenuService.GenerateRibbonMenuGroup(groupId, "Sample Group", new IRibbonMenu[] { button });
			var tabId = Guid.NewGuid();
			var tab = m_RibbonMenuService.GenerateRibbonMenuTab(tabId, "Sample Tab");

			m_RibbonMenuService.AddRibbonMenuGroup(tabId, group);
			//			m_RibbonMenuService.AddRibbonMenuTab(tab);

		}

		void ShowSampleGUI()
		{
			m_DialogBoxService.ShowFluentDialogWithEmbeddedUIElement(IDialogBoxService.ModalityType.Modeless, "Sample Window", new SampleGUI());
		}
	}
</code></pre>
       <ol start="8">
        <li>
         <p>
          Build the HSampleGUIPlugin project.
         </p>
        </li>
        <li>
         <p>
          Sample GUIIPlugin generated
          <strong>
           .dll
          </strong>
          "Sample GUIIPlugin".
          <strong>
           .deps.json
          </strong>
          plug-in folder (
          <a href="#module-loading">
           See Module Loading
          </a>
          Copy it to your computer.
          <strong>
           Do not copy the assemblies of the distributed FEMTUS plug-in SDK.
          </strong>
          <img alt="" src="docs/images/PutSampleGUIPlugin.jpg"/>
         </p>
        </li>
        <li>
         <p>
          Launch FEMTUS.When the ribbon menu is added, click the button to see the SampleGUI screen.
         </p>
        </li>
       </ol>
       <p>
        <img alt="" src="docs/images/ExecutionOfSampleGUI.jpg"/>
       </p>
      </article>
     </div>
     <div class="hidden-sm col-md-2" role="complementary">
      <div class="sideaffix">
       <div class="contribution">
        <ul class="nav">
         <li>
          <a class="contribution-link" href="https://jeol-em-1g.visualstudio.com/Donau/_git/FEMTUS?path=docs/index.md&amp;version=GBmain&amp;line=1">
           Edit this page
          </a>
         </li>
        </ul>
       </div>
       <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
        <h5>
         In this article
        </h5>
        <div>
        </div>
       </nav>
      </div>
     </div>
    </div>
   </div>
   <footer>
    <div class="grad-bottom">
    </div>
    <div class="footer">
     <div class="container">
      <span class="pull-right">
       <a href="#top">
        Back to top
       </a>
      </span>
      <span>
       Generated by
       <strong>
        DocFX
       </strong>
      </span>
     </div>
    </div>
   </footer>
  </div>
  <script src="styles/docfx.vendor.min.js" type="text/javascript">
  </script>
  <script src="styles/docfx.js" type="text/javascript">
  </script>
  <script src="styles/main.js" type="text/javascript">
  </script>
 </body>
</html>
